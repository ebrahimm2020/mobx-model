{"version":3,"sources":["../src/restful_actions_mixin.js"],"names":["addClassAction","attributes","name","request","method","data","endpoint","urlRoot","onSuccess","options","json","body","model","set","modelJson","jsonKey","topLevelJson","afterCreate","id","isIncludeDeleted","include_deleted","addAction","afterUpdate","onDestroy","afterDestroy"],"mappings":";;AAAA;;;;AACA;;;;AAEA;;;;AACA;;;;;;AAGA,qBAAUA,cAAV,CAAyB,QAAzB,EAAmC,UAASC,UAAT,EAAqB;AAAA;;AAEtD,MAAI,wBAASA,UAAT,CAAJ,EAA0B;AACxBA,iBAAa,EAAEC,MAAMD,UAAR,EAAb;AACD;;AAED,SAAO,cAAIE,OAAJ,CAAY;AACjBC,YAAQ,MADS;AAEjBC,UAAMJ,UAFW;AAGjBK,cAAU,KAAKC,OAHE;AAIjBC,eAAW,qBAAkB;AAAA,UAAjBC,OAAiB,uEAAP,EAAO;;AAC3B,UAAMC,OAAOD,QAAQE,IAArB;;AAEA,UAAIC,QAAQ,MAAKC,GAAL,CAAS;AACnBC,mBAAWJ,KAAK,MAAKK,OAAV,CADQ;AAEnBC,sBAAcN;AAFK,OAAT,CAAZ;;AAKA,UAAI,0BAAWE,MAAMK,WAAjB,CAAJ,EAAmC;AACjCL,cAAMK,WAAN,CAAkBR,OAAlB;AACD;AAEF;AAhBgB,GAAZ,CAAP;AAkBD,CAxBD;;AA2BA,qBAAUT,cAAV,CAAyB,MAAzB,EAAiC,UAASkB,EAAT,EAAaC,gBAAb,EAA+B;AAAA;;AAC9D,SAAO,cAAIhB,OAAJ,CAAY;AACjBG,cAAa,KAAKC,OAAlB,SAA6BW,EADZ;AAEjBb,UAAM;AACJe,uBAAiBD;AADb,KAFW;AAKjBX,eAAW,qBAAkB;AAAA,UAAjBC,OAAiB,uEAAP,EAAO;;AAC3B,UAAMC,OAAOD,QAAQE,IAArB;;AAEA,aAAKE,GAAL,CAAS;AACPC,mBAAWJ,KAAK,OAAKK,OAAV,CADJ;AAEPC,sBAAcN;AAFP,OAAT;AAKD;AAbgB,GAAZ,CAAP;AAeD,CAhBD;;AAmBA,qBAAUW,SAAV,CAAoB,QAApB,EAA8B,YAA0B;AAAA;;AAAA,MAAjBpB,UAAiB,uEAAJ,EAAI;;AACtD,SAAO,cAAIE,OAAJ,CAAY;AACjBC,YAAQ,KADS;AAEjBC,UAAMJ,UAFW;AAGjBK,cAAa,KAAKC,OAAlB,SAA6B,KAAKW,EAHjB;AAIjBV,eAAW,qBAAkB;AAAA,UAAjBC,OAAiB,uEAAP,EAAO;;AAC3B,UAAMC,OAAOD,QAAQE,IAArB;;AAEA,aAAKE,GAAL,CAAS;AACPC,mBAAWJ,KAAK,OAAKK,OAAV,CADJ;AAEPC,sBAAcN;AAFP,OAAT;;AAKA,UAAI,0BAAW,OAAKY,WAAhB,CAAJ,EAAkC;AAChC,eAAKA,WAAL,CAAiBb,OAAjB;AACD;AAEF;AAhBgB,GAAZ,CAAP;AAkBD,CAnBD;;AAsBA,qBAAUY,SAAV,CAAoB,SAApB,EAA+B,YAAW;AAAA;;AACxC,SAAO,cAAIlB,OAAJ,CAAY;AACjBC,YAAQ,KADS;AAEjBE,cAAa,KAAKC,OAAlB,SAA6B,KAAKW,EAFjB;AAGjBV,eAAW,qBAAkB;AAAA,UAAjBC,OAAiB,uEAAP,EAAO;;AAC3B,aAAKc,SAAL;;AAEA,UAAI,0BAAW,OAAKC,YAAhB,CAAJ,EAAmC;AACjC,eAAKA,YAAL,CAAkBf,OAAlB;AACD;AAEF;AAVgB,GAAZ,CAAP;AAYD,CAbD","file":"restful_actions_mixin.js","sourcesContent":["import API from './api';\nimport BaseModel from './base_model';\n\nimport isString from 'lodash/isString';\nimport isFunction from 'lodash/isFunction';\n\n\nBaseModel.addClassAction('create', function(attributes) {\n\n  if (isString(attributes)) {\n    attributes = { name: attributes }\n  }\n\n  return API.request({\n    method: 'post',\n    data: attributes,\n    endpoint: this.urlRoot,\n    onSuccess: (options = {}) => {\n      const json = options.body;\n\n      let model = this.set({\n        modelJson: json[this.jsonKey],\n        topLevelJson: json\n      });\n\n      if (isFunction(model.afterCreate)) {\n        model.afterCreate(options);\n      }\n\n    }\n  });\n});\n\n\nBaseModel.addClassAction('load', function(id, isIncludeDeleted) {\n  return API.request({\n    endpoint: `${this.urlRoot}/${id}`,\n    data: {\n      include_deleted: isIncludeDeleted\n    },\n    onSuccess: (options = {}) => {\n      const json = options.body;\n\n      this.set({\n        modelJson: json[this.jsonKey],\n        topLevelJson: json\n      });\n\n    }\n  })\n});\n\n\nBaseModel.addAction('update', function(attributes = {}) {\n  return API.request({\n    method: 'put',\n    data: attributes,\n    endpoint: `${this.urlRoot}/${this.id}`,\n    onSuccess: (options = {}) => {\n      const json = options.body;\n\n      this.set({\n        modelJson: json[this.jsonKey],\n        topLevelJson: json\n      });\n\n      if (isFunction(this.afterUpdate)) {\n        this.afterUpdate(options);\n      }\n\n    }\n  });\n});\n\n\nBaseModel.addAction('destroy', function() {\n  return API.request({\n    method: 'del',\n    endpoint: `${this.urlRoot}/${this.id}`,\n    onSuccess: (options = {}) => {\n      this.onDestroy();\n\n      if (isFunction(this.afterDestroy)) {\n        this.afterDestroy(options);\n      }\n\n    }\n  });\n});\n\n"]}